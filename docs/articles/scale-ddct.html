<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Delta Delta Ct, Center on One Experimental Condition • fluidgr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Delta Delta Ct, Center on One Experimental Condition">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fluidgr</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/load-normalize.html">Load and Normalize the qPCR Output</a>
    </li>
    <li>
      <a href="../articles/scale-ddct.html">Delta Delta Ct, Center on One Experimental Condition</a>
    </li>
    <li>
      <a href="../articles/scale-plot.html">Scale and Visualize qPCR results</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Delta Delta Ct, Center on One Experimental Condition</h1>
                        <h4 class="author">Otho Mantegazza</h4>
            
            <h4 class="date">2018-12-05</h4>
      
      
      <div class="hidden name"><code>scale-ddct.Rmd</code></div>

    </div>

    
    
<p>Here, you will learn how to scale, inspect and visualize the gene expression data by centering the mesurement on one single experimental condition (in what is known as the <span class="math inline">\(2^{ - \Delta \Delta Ct}\)</span> method).</p>
<p>This method is useful when you want to take one experimental condition as reference. For example, the start time when analyzing time series.</p>
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(fluidgr)
<span class="kw">library</span>(magrittr)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(stringr)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(forcats)
<span class="kw">library</span>(scales)
<span class="kw">library</span>(devtools)
<span class="kw">library</span>(purrr)</code></pre></div>
</div>
<div id="data" class="section level1">
<h1 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h1>
<p>We use the <code>scaled_fluidigm</code> dataset to illustrate how to apply the <span class="math inline">\(2^{ - \Delta \Delta Ct}\)</span> method.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(scaled_fluidigm)</code></pre></div>
</div>
<div id="how-to-use-the-function-scale_ddct" class="section level1">
<h1 class="hasAnchor">
<a href="#how-to-use-the-function-scale_ddct" class="anchor"></a>How to use the function <code><a href="../reference/scale_ddct.html">scale_ddct()</a></code>
</h1>
<p>Using the <span class="math inline">\(2^{ - \Delta \Delta Ct}\)</span> method on large scale qPCR experiments is often not straightforward, because those experiments are often multivariate.</p>
<p>For example, the <code>scaled_fluidigm</code> is measures the expression of four genes (encoded in the column <code>target_name</code>) in the combination of two variables:</p>
<ul>
<li>5 different species, encoded in the column <code>species</code> .</li>
<li>4 different developmental stages, encoded in the column <code>stage</code>.</li>
</ul>
<p>See below</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">scaled_fluidigm <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(target_name, species, stage) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/purrr/topics/map">map</a></span>(unique)
<span class="co">#&gt; $target_name</span>
<span class="co">#&gt; [1] "gene1" "gene4" "gene2" "gene3"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $species</span>
<span class="co">#&gt; [1] "J" "G" "B" "R" "I"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $stage</span>
<span class="co">#&gt; [1] "N2" "N1" "N4" "N3"</span></code></pre></div>
<p>We want to split this dataset by species and gene and compare directly only the measurement in the stage variable. (i.e. we want to scale and compare gene expression in the four stages, for every gene in every species separately)</p>
<p>Moreover, we want a specific stage to be used as reference. The mean in that stage will be set to 1 and expression in every other stage will be expressed in relative terms to that. Let that stage be “N1”</p>
<p>You achieve this using the function <code><a href="../reference/scale_ddct.html">scale_ddct()</a></code> (ddct stands for delta delta Ct). <code><a href="../reference/scale_ddct.html">scale_ddct()</a></code> takes four arguments</p>
<ul>
<li>
<code>.data</code> a fluidigm dataset</li>
<li>
<code>...</code> the dots must be filled with all the columns of <code>.data</code> that you want to use to split it.</li>
<li>
<code>compare_var</code> the column of data used for direct comparison, which must store the value as reference.</li>
<li>
<code>center_on</code> the value used as reference, its mean expression will be set to 1.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ddct_flluidigm &lt;-<span class="st"> </span>
<span class="st">  </span>scaled_fluidigm <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># the .data parameter is filled by the pipe</span>
<span class="st">  </span><span class="kw"><a href="../reference/scale_ddct.html">scale_ddct</a></span>(
    species, target_name, <span class="co"># fill the dots ... with the columns that you want to use to split .data</span>
    <span class="dt">compare_var =</span> stage, <span class="co"># direct comparison</span>
    <span class="dt">center_on =</span> <span class="st">"N1"</span> <span class="co"># reference expression, set to 1</span>
  )</code></pre></div>
<p>Using this function might be confusing because it uses <strong>dots</strong> <code>...</code> to capture any number of column names to split the data. Remember that the arguments after the dots (<code>compare_var</code> and <code>center_on</code>) must be named.</p>
</div>
<div id="plot" class="section level1">
<h1 class="hasAnchor">
<a href="#plot" class="anchor"></a>Plot</h1>
<p>The output of <code>ddct_fluidigm()</code> can be plotted directly with ggplot2.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ddct_flluidigm <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> stage,
               <span class="dt">y =</span> ddct_exp,
               <span class="dt">group =</span> species,
               <span class="dt">colour =</span> species)) <span class="op">+</span>
<span class="st">  </span><span class="co"># it might be complicated to add a line that connect means</span>
<span class="st">  </span><span class="co"># across stages,</span>
<span class="st">  </span><span class="co"># because stages are encoded as a categorical variable,</span>
<span class="st">  </span><span class="co"># we must turn them into numeric</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> stage <span class="op">%&gt;%</span>
<span class="st">                     </span><span class="kw">as.factor</span>(.) <span class="op">%&gt;%</span>
<span class="st">                     </span><span class="kw">as.numeric</span>(.)),
               <span class="dt">fun.y =</span> mean,
               <span class="dt">geom=</span><span class="st">"line"</span>,
               <span class="dt">size =</span> <span class="fl">1.2</span>,
               <span class="dt">alpha =</span> .<span class="dv">7</span>,
               <span class="dt">linejoin =</span> <span class="st">"round"</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># implement facetting with independent y values</span>
<span class="st">  </span><span class="co"># for each genes, since expression values are</span>
<span class="st">  </span><span class="co"># not comparable across genes</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="dt">facet =</span> <span class="st">"target_name"</span>,
             <span class="dt">scales =</span> <span class="st">"free"</span>,
             <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() </code></pre></div>
<p><img src="scale-ddct_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div id="how-delta-delta-ct-are-estimated-in-fluidgr" class="section level1">
<h1 class="hasAnchor">
<a href="#how-delta-delta-ct-are-estimated-in-fluidgr" class="anchor"></a>How <span class="math inline">\(\Delta \Delta Ct\)</span> are estimated in fluidgr</h1>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#setup">Setup</a></li>
      <li><a href="#data">Data</a></li>
      <li><a href="#how-to-use-the-function-scale_ddct">How to use the function <code><a href="--/reference/scale_ddct-html">scale_ddct()</a></code></a></li>
      <li><a href="#plot">Plot</a></li>
      <li><a href="#how-delta-delta-ct-are-estimated-in-fluidgr">How <span class="math inline">\(\Delta \Delta Ct\)</span> are estimated in fluidgr</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Otho Mantegazza.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
