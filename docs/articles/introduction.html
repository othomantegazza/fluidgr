<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to Fluidgr • fluidgr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to Fluidgr">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fluidgr</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction.html">Introduction to Fluidgr</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to Fluidgr</h1>
                        <h4 class="author">Otho Mantegazza</h4>
            
            <h4 class="date">2018-11-12</h4>
      
      
      <div class="hidden name"><code>introduction.Rmd</code></div>

    </div>

    
    
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(fluidgr)
<span class="kw">library</span>(magrittr)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(stringr)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(forcats)
<span class="kw">library</span>(scales)
<span class="kw">library</span>(devtools)</code></pre></div>
</div>
<div id="simple-workflow" class="section level1">
<h1 class="hasAnchor">
<a href="#simple-workflow" class="anchor"></a>Simple Workflow</h1>
<p>Record the path to your fluidigm CSV data and the name of your reference normalizers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">path_to_data &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"sample-fluidigm-run.csv"</span>,
                            <span class="dt">package =</span> <span class="st">"fluidgr"</span>,
                            <span class="dt">mustWork =</span> <span class="ot">TRUE</span>)

normalizers &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"normalizer1"</span>,
                 <span class="st">"normalizer2"</span>,
                 <span class="st">"normalizer3"</span>)</code></pre></div>
<p>Parse them, normalize them and scale them in a <a href="https://magrittr.tidyverse.org/index.html">magrittr</a> pipe.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fluidigm_data &lt;-<span class="st"> </span>
<span class="st">  </span>path_to_data <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/read_fluidigm.html">read_fluidigm</a></span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/normalize.html">normalize</a></span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/scale_fluidigm.html">scale_fluidigm</a></span>()</code></pre></div>
<p>And your data are ready to be saved on disk or plotted with ggplot2.</p>
<p>In the next paragraphs you’ll find this same workflow explained in details.</p>
</div>
<div id="load-your-data-into-r" class="section level1">
<h1 class="hasAnchor">
<a href="#load-your-data-into-r" class="anchor"></a>Load your data into R</h1>
<p>You can start by loading the output of the Fluidigm digital real time machine into R. This output is in a standard CSV format with a 10 lines header and triple column names, you can find <a href="https://github.com/othomantegazza/fluidgr/blob/master/inst/extdata/sample-fluidigm-run.csv">an example of such file here</a>.</p>
<p>Access the path to that sample CSV file in R with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">path_to_data &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"sample-fluidigm-run.csv"</span>,
                            <span class="dt">package =</span> <span class="st">"fluidgr"</span>,
                            <span class="dt">mustWork =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>And load it with the funciton <code><a href="../reference/read_fluidigm.html">read_fluidigm()</a></code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_fluidigm.html">read_fluidigm</a></span>(<span class="dt">path =</span> path_to_data)</code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   chamber_id = col_character(),
##   sample_name = col_character(),
##   sample_type = col_character(),
##   sample_rconc = col_double(),
##   target_name = col_character(),
##   target_type = col_character(),
##   ct_value = col_double(),
##   ct_calibrated_rconc = col_double(),
##   ct_quality = col_double(),
##   ct_call = col_character(),
##   ct_threshold = col_double(),
##   tm_inrange = col_double(),
##   tm_outrange = col_integer(),
##   tm_peakratio = col_integer(),
##   comments = col_character()
## )</code></pre>
<div id="tidy-your-data" class="section level2">
<h2 class="hasAnchor">
<a href="#tidy-your-data" class="anchor"></a>Tidy your Data</h2>
<p>After you have parsed the data, you can modify them as you wish using <a href="https://dplyr.tidyverse.org/articles/dplyr.html">dplyr</a>.</p>
<div id="remove-samples" class="section level3">
<h3 class="hasAnchor">
<a href="#remove-samples" class="anchor"></a>Remove samples</h3>
<p>For example, you might want to remove selected samples:</p>
<p>Our example dataset contains samples that are dilution used for calibration curves.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat<span class="op">$</span>sample_name <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unique</span>()</code></pre></div>
<pre><code>##  [1] "H20"           "J-N2R3"        "R- Mix 1/160"  "J-N2R2"       
##  [5] "R- Mix 1/80"   "J-N2R1"        "R- Mix 1/40"   "J-N1R3"       
##  [9] "R- Mix 1/20"   "J-N1R2"        "R- Mix 1/10"   "J-N1R1"       
## [13] "R- Mix"        "J-N4R3"        "J-N4R2"        "I -Mix 1/160" 
## [17] "J-N4R1"        "I -Mix 1/80"   "J-N3R3"        "I -Mix 1/40"  
## [21] "J-N3R2"        "I -Mix 1/20"   "J-N3R1"        "I -Mix 1/10"  
## [25] "G-N2R3"        "I - Mix"       "G-N2R2"        "G-N2R1"       
## [29] "B - Mix 1/160" "G-N1R3"        "B -Mix 1/80"   "G-N1R2"       
## [33] "B -Mix 1/40"   "G-N1R1"        "B -Mix 1/20"   "G-N4R3"       
## [37] "B -Mix 1/10"   "G-N4R2"        "B - Mix"       "G-N4R1"       
## [41] "G-N3R3"        "G-Mix 1/160"   "G-N3R2"        "G-Mix 1/80"   
## [45] "G-N3R1"        "G-Mix 1/40"    "B-N2R3"        "G-Mix 1/20"   
## [49] "B-N2R2"        "G- Mix 1/10"   "B-N2R1"        "G-Mix"        
## [53] "B-N1R3"        "B-N1R2"        "J - Mix 1/160" "B-N1R1"       
## [57] "J - Mix 1/80"  "B-N4R3"        "J - Mix 1/40"  "B-N4R2"       
## [61] "J - Mix 1/20"  "B-N4R1"        "J - Mix 1/10"  "B-N3R3"       
## [65] "J - Mix"       "B-N3R2"        "B-N3R1"        "R-N4R3"       
## [69] "I-N2R3"        "R-N4R2"        "I-N2R2"        "R-N4R1"       
## [73] "I-N2R1"        "R-N3R3"        "I-N1R3"        "R-N3R2"       
## [77] "I-N1R2"        "R-N3R1"        "I-N1R1"        "R-N2R3"       
## [81] "I-N4R3"        "R-N2R2"        "I-N4R2"        "R-N2R1"       
## [85] "I-N4R1"        "R-N1R3"        "I-N3R3"        "R-N1R2"       
## [89] "I-N3R2"        "R-N1R1"        "I-N3R1"</code></pre>
<p>Those samples, all have the word “Mix” in their name, and can be removed with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span>
<span class="st">  </span>dat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="op">!</span>sample_name <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/stringr/topics/str_detect">str_detect</a></span>(<span class="st">"Mix"</span>))</code></pre></div>
<p>One sample “H2O” is a negative control, it also can be removed:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span>
<span class="st">  </span>dat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(sample_name <span class="op">!=</span><span class="st"> "H20"</span>)</code></pre></div>
</div>
<div id="check-measurements-per-sample" class="section level3">
<h3 class="hasAnchor">
<a href="#check-measurements-per-sample" class="anchor"></a>Check measurements per sample</h3>
<p>You can check that each sample has been measured the same number of times:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat<span class="op">$</span>sample_name <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">table</span>()</code></pre></div>
<pre><code>## .
## B-N1R1 B-N1R2 B-N1R3 B-N2R1 B-N2R2 B-N2R3 B-N3R1 B-N3R2 B-N3R3 B-N4R1 
##      8      8      8      8      8      8      8      8      8      8 
## B-N4R2 B-N4R3 G-N1R1 G-N1R2 G-N1R3 G-N2R1 G-N2R2 G-N2R3 G-N3R1 G-N3R2 
##      8      8      8      8      8      8      8      8      8      8 
## G-N3R3 G-N4R1 G-N4R2 G-N4R3 I-N1R1 I-N1R2 I-N1R3 I-N2R1 I-N2R2 I-N2R3 
##      8      8      8      8      8      8      8      8      8      8 
## I-N3R1 I-N3R2 I-N3R3 I-N4R1 I-N4R2 I-N4R3 J-N1R1 J-N1R2 J-N1R3 J-N2R1 
##      8      8      8      8      8      8      8      8      8      8 
## J-N2R2 J-N2R3 J-N3R1 J-N3R2 J-N3R3 J-N4R1 J-N4R2 J-N4R3 R-N1R1 R-N1R2 
##      8      8      8      8      8      8      8      8      8      8 
## R-N1R3 R-N2R1 R-N2R2 R-N2R3 R-N3R1 R-N3R2 R-N3R3 R-N4R1 R-N4R2 R-N4R3 
##      8      8      8      8      8      8      8      8      8      8</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat<span class="op">$</span>sample_name <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">table</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unique</span>()</code></pre></div>
<pre><code>## [1] 8</code></pre>
</div>
<div id="check-for-duplicated-targets" class="section level3">
<h3 class="hasAnchor">
<a href="#check-for-duplicated-targets" class="anchor"></a>Check for duplicated targets</h3>
<p>Also, one of the target is a duplicated normalizer. You can remove it with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat<span class="op">$</span>target_name <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unique</span>()</code></pre></div>
<pre><code>## [1] "normalizer1"    "gene1"          "gene4"          "gene2"         
## [5] "normalizer2"    "normalizer3"    "normalizer1bis" "gene3"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span>
<span class="st">  </span>dat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(target_name <span class="op">!=</span><span class="st"> "normalizer1bis"</span>)</code></pre></div>
</div>
</div>
</div>
<div id="normalize" class="section level1">
<h1 class="hasAnchor">
<a href="#normalize" class="anchor"></a>Normalize</h1>
<p>You must provide the names of the normalizers exactly as they are stored in the <code>target_name</code> column. In this case the name of the normalizers is: <code>normalizer1</code>, <code>normalizer2</code> and <code>normalizer3</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">normalizers &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"normalizer1"</span>,
                 <span class="st">"normalizer2"</span>,
                 <span class="st">"normalizer3"</span>)

norm_dat &lt;-<span class="st"> </span>
<span class="st">  </span>dat <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/normalize.html">normalize</a></span>(<span class="dt">normalizers =</span> normalizers) </code></pre></div>
<p>The <code><a href="../reference/normalize.html">normalize()</a></code> function takes the data parsed by <code><a href="../reference/read_fluidigm.html">read_fluidigm()</a></code> as object and returns the same data with two additional columns:</p>
<ul>
<li>
<code>norm_geom_mean</code> stores the geometric mean of normalizers for each sample.</li>
<li>
<code>expression</code> stores the normalized expression values.</li>
</ul>
<p>Expression values are normalized with the formula:</p>
<p><span class="math display">\[expression = 2^{-(C_T - C_Tnorm)}\]</span></p>
<p>Where, for each well, <span class="math inline">\(C_T\)</span> is the recorded threshold cycle (<code>ct_value</code>) and <span class="math inline">\(C_Tnorm\)</span> is the geometric mean of the normalizers C<sub>T</sub> values.</p>
<p>This formula is a simplification of the common <span class="math inline">\(2^{ - \Delta \Delta Ct}\)</span> formula that skips calibration.</p>
</div>
<div id="scale" class="section level1">
<h1 class="hasAnchor">
<a href="#scale" class="anchor"></a>Scale</h1>
<p>Scaling is not necessary, and you can communicate and visualize directly the normalized expression values; stored in the <code>expression</code> column of the <code>norm_dat</code> dataset.</p>
<p>Indeed scaling is not necessary, but, together with exploratory plots, scaling can help you detect patterns in your data. You can understand better the outcome of scaling when you visualize tour data in plots. This is why you can learn about the effects of scaling also in the next section “Visualize”.</p>
<div id="scale-with-the-scale_fluidigm-function" class="section level3">
<h3 class="hasAnchor">
<a href="#scale-with-the-scale_fluidigm-function" class="anchor"></a>Scale with the <code><a href="../reference/scale_fluidigm.html">scale_fluidigm()</a></code> function</h3>
<p>Fluidgr provides the <code><a href="../reference/scale_fluidigm.html">scale_fluidigm()</a></code> function, that scales expression values by z-score according to the groups provided in the argument <code>.group</code>.</p>
<p>This function takes the dataset output of <code><a href="../reference/normalize.html">normalize()</a></code> and returns the same dataset with the extra column <code>scaled_expression</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">scaled_dat &lt;-<span class="st"> </span>
<span class="st">  </span>norm_dat <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/scale_fluidigm.html">scale_fluidigm</a></span>(<span class="dt">.group =</span> target_name)</code></pre></div>
</div>
<div id="write-your-own-scaling-function" class="section level3">
<h3 class="hasAnchor">
<a href="#write-your-own-scaling-function" class="anchor"></a>Write your own scaling function</h3>
<p>You can write your own scaling function, becaus <code><a href="../reference/scale_fluidigm.html">scale_fluidigm()</a></code> function is just a soft wrapper around dplyr’s <code><a href="http://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> and <code><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>. If you want to try different scaling methods, you can replicate and tweak the output of <code><a href="../reference/scale_fluidigm.html">scale_fluidigm()</a></code> with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">norm_dat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(target_name) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">scaled_expression =</span> <span class="kw">scale</span>(expression))</code></pre></div>
<p>This should provide to you a good basis and enough freedom to explore and visualize your data as you prefer.</p>
</div>
</div>
<div id="visualize" class="section level1">
<h1 class="hasAnchor">
<a href="#visualize" class="anchor"></a>Visualize</h1>
<p>Fluidigmr does not provide plotting function, because all the functions that you need to plot this kind of data are already available in <a href="https://ggplot2.tidyverse.org/">ggplot2</a>. Indeed the dataset output of is already in a <a href="http://r4ds.had.co.nz/tidy-data.html">tidy/gathered format</a>.</p>
<p>Here we provide some ideas of how you can explore, plot and visualize your Fluidigm data.</p>
<div id="what-variables-are-in-your-data" class="section level2">
<h2 class="hasAnchor">
<a href="#what-variables-are-in-your-data" class="anchor"></a>What variables are in your data?</h2>
<p>Make the variables in your data explicit.</p>
<p>Effective visualization depends from the variable that determine the effect in your dataset and eventually by the question that you are trying to anwser.</p>
<p>For example in the sample dataset we are measuring the expression of four genes in 4 developmental stages in 5 species. The column <code>target_name</code> records the “gene” variable, while the other two variables, developmental stage and species, are hidden in the <code>sample_name</code> variable. We can make them explicit.</p>
<p>The <code>sample_name</code> variable is encoded as “J-N1R1”:</p>
<ul>
<li>The first letter “J” is the species.</li>
<li>The letter and the number after the hyphen “N1” encode for the stage.</li>
<li>The last letter and number “R1” encode for the replicate.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">norm_dat &lt;-<span class="st"> </span>
<span class="st">  </span>norm_dat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># make species explicit</span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">species =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/stringr/topics/str_split">str_split_fixed</a></span>(<span class="dt">string =</span> sample_name,
                                   <span class="dt">pattern =</span> <span class="st">"-"</span>,
                                   <span class="dt">n =</span> <span class="dv">2</span>)[, <span class="dv">1</span>]) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># make stage explicit</span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">stage =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/stringr/topics/str_sub">str_sub</a></span>(<span class="dt">string =</span> sample_name,
                         <span class="dt">start =</span> <span class="dv">3</span>,
                         <span class="dt">end =</span> <span class="dv">4</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># make replicate explicit</span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">replicate =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/stringr/topics/str_sub">str_sub</a></span>(<span class="dt">string =</span> sample_name,
                         <span class="dt">start =</span> <span class="dv">5</span>,
                         <span class="dt">end =</span> <span class="dv">6</span>))</code></pre></div>
</div>
<div id="lineplot" class="section level2">
<h2 class="hasAnchor">
<a href="#lineplot" class="anchor"></a>Lineplot</h2>
<p>A lineplot can be informative directly on normalized data, without scaling.</p>
<p>You can use facets to display multivariate data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span>norm_dat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> stage,
             <span class="dt">y =</span> expression)) <span class="op">+</span>
<span class="st">  </span><span class="co"># plot each expression value into a point</span>
<span class="st">  </span><span class="kw"><a href="ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="dt">size =</span> <span class="dv">2</span>,
               <span class="dt">col =</span> <span class="st">"#DA614D"</span>,
               <span class="dt">alpha =</span> .<span class="dv">8</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># it might be complicated to add a line that connect means</span>
<span class="st">  </span><span class="co"># across stages,</span>
<span class="st">  </span><span class="co"># because stages are encoded as a categorical variable,</span>
<span class="st">  </span><span class="co"># we must turn them into numeric</span>
<span class="st">  </span><span class="kw"><a href="ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span>(<span class="kw"><a href="ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> stage <span class="op">%&gt;%</span>
<span class="st">                     </span><span class="kw">as.factor</span>(.) <span class="op">%&gt;%</span>
<span class="st">                     </span><span class="kw">as.numeric</span>(.)),
               <span class="dt">fun.y =</span> mean,
               <span class="dt">geom=</span><span class="st">"line"</span>,
               <span class="dt">size =</span> <span class="fl">1.2</span>,
               <span class="dt">alpha =</span> .<span class="dv">7</span>,
               <span class="dt">linejoin =</span> <span class="st">"round"</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># implement facetting with independent y values</span>
<span class="st">  </span><span class="co"># for each genes, since expression values are</span>
<span class="st">  </span><span class="co"># not comparable across genes</span>
<span class="st">  </span><span class="kw"><a href="ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span>(target_name <span class="op">~</span><span class="st"> </span>species,
               <span class="dt">scales =</span> <span class="st">"free_y"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() 

p <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print</span>()</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>Some patterns in your data might be more evident if you plot them in log scale.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_log &lt;-<span class="st"> </span>
<span class="st">  </span>p <span class="op">+</span><span class="st"> </span><span class="kw"><a href="ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_log10</a></span>()

p_log <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print</span>()</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>Also using heatmap with ggplot2</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_heat &lt;-<span class="st"> </span>
<span class="st">  </span>norm_dat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> stage,
             <span class="dt">y =</span> target_name,
             <span class="dt">fill =</span> expression)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span>(. <span class="op">~</span><span class="st"> </span>species) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span>()

p_heat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print</span>()</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>Sometime heatmap don’t convey muich invormation if you don’t scale your data.</p>
<p>For example we can scale every gene on z-score to make them comparable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">scaled_gene &lt;-<span class="st"> </span>
<span class="st">  </span>norm_dat <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(target_name) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">scaled_expression =</span> expression <span class="op">%&gt;%</span>
<span class="st">           </span><span class="kw"><a href="http://www.rdocumentation.org/packages/scales/topics/rescale">rescale</a></span>(<span class="dt">from =</span> <span class="kw">range</span>(.), <span class="dt">to =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)))</code></pre></div>
<p>Check if the heatmap has improved</p>
<p><strong>remeber to map the colours to the new <code>scaled_expression</code> values</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_heat &lt;-<span class="st"> </span>
<span class="st">  </span>scaled_gene <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> stage,
             <span class="dt">y =</span> species,
             <span class="dt">fill =</span> scaled_expression)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span>(. <span class="op">~</span><span class="st"> </span>target_name) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span>()

p_heat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print</span>()</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>We can try to set more groups.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">scaled_dat &lt;-<span class="st"> </span>
<span class="st">  </span>norm_dat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(target_name, species) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">scaled_expression =</span> expression <span class="op">%&gt;%</span>
<span class="st">           </span><span class="kw"><a href="http://www.rdocumentation.org/packages/scales/topics/rescale">rescale</a></span>(<span class="dt">from =</span> <span class="kw">range</span>(.), <span class="dt">to =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)))</code></pre></div>
<p>Check if the heatmap has improved</p>
<p><strong>remeber to map the colours to the new <code>scaled_expression</code> values</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_heat &lt;-<span class="st"> </span>
<span class="st">  </span>scaled_dat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> stage,
             <span class="dt">y =</span> species,
             <span class="dt">fill =</span> scaled_expression)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span>(. <span class="op">~</span><span class="st"> </span>target_name) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span>()

p_heat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print</span>()</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
</div>
</div>
<div id="session-info" class="section level1">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session Info</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/reexports">session_info</a></span>()</code></pre></div>
<pre><code>## ─ Session info ──────────────────────────────────────────────────────────
##  setting  value                       
##  version  R version 3.4.4 (2018-03-15)
##  os       Ubuntu 16.04.5 LTS          
##  system   x86_64, linux-gnu           
##  ui       X11                         
##  language en_US                       
##  collate  en_US.UTF-8                 
##  ctype    en_US.UTF-8                 
##  tz       Europe/Paris                
##  date     2018-11-12                  
## 
## ─ Packages ──────────────────────────────────────────────────────────────
##  package     * version date       lib source        
##  assertthat    0.2.0   2017-04-11 [1] CRAN (R 3.4.4)
##  backports     1.1.2   2017-12-13 [1] CRAN (R 3.4.4)
##  base64enc     0.1-3   2015-07-28 [1] CRAN (R 3.4.4)
##  bindr         0.1.1   2018-03-13 [1] CRAN (R 3.4.4)
##  bindrcpp    * 0.2.2   2018-03-29 [1] CRAN (R 3.4.4)
##  callr         3.0.0   2018-08-24 [1] CRAN (R 3.4.4)
##  cli           1.0.1   2018-09-25 [1] CRAN (R 3.4.4)
##  colorspace    1.3-2   2016-12-14 [1] CRAN (R 3.4.4)
##  commonmark    1.6     2018-09-30 [1] CRAN (R 3.4.4)
##  crayon        1.3.4   2017-09-16 [1] CRAN (R 3.4.4)
##  debugme       1.1.0   2017-10-22 [1] CRAN (R 3.4.4)
##  desc          1.2.0   2018-05-01 [1] CRAN (R 3.4.4)
##  devtools    * 2.0.0   2018-10-19 [1] CRAN (R 3.4.4)
##  digest        0.6.18  2018-10-10 [1] CRAN (R 3.4.4)
##  dplyr       * 0.7.7   2018-10-16 [1] CRAN (R 3.4.4)
##  evaluate      0.12    2018-10-09 [1] CRAN (R 3.4.4)
##  fluidgr     * 0.0.1   2018-11-12 [1] local         
##  forcats     * 0.3.0   2018-02-19 [1] CRAN (R 3.4.4)
##  fs            1.2.6   2018-08-23 [1] CRAN (R 3.4.4)
##  ggplot2     * 3.0.0   2018-07-03 [1] CRAN (R 3.4.4)
##  glue          1.3.0   2018-07-17 [1] CRAN (R 3.4.4)
##  gtable        0.2.0   2016-02-26 [1] CRAN (R 3.4.4)
##  hms           0.4.2   2018-03-10 [1] CRAN (R 3.4.4)
##  htmltools     0.3.6   2017-04-28 [1] CRAN (R 3.4.4)
##  knitr         1.20    2018-02-20 [1] CRAN (R 3.4.4)
##  labeling      0.3     2014-08-23 [1] CRAN (R 3.4.4)
##  lazyeval      0.2.1   2017-10-29 [1] CRAN (R 3.4.4)
##  magrittr    * 1.5     2014-11-22 [1] CRAN (R 3.4.4)
##  MASS          7.3-50  2018-04-30 [4] CRAN (R 3.4.4)
##  memoise       1.1.0   2017-04-21 [1] CRAN (R 3.4.4)
##  munsell       0.5.0   2018-06-12 [1] CRAN (R 3.4.4)
##  pillar        1.3.0   2018-07-14 [1] CRAN (R 3.4.4)
##  pkgbuild      1.0.2   2018-10-16 [1] CRAN (R 3.4.4)
##  pkgconfig     2.0.2   2018-08-16 [1] CRAN (R 3.4.4)
##  pkgdown       1.1.0   2018-06-02 [1] CRAN (R 3.4.4)
##  pkgload       1.0.1   2018-10-11 [1] CRAN (R 3.4.4)
##  plyr          1.8.4   2016-06-08 [1] CRAN (R 3.4.4)
##  prettyunits   1.0.2   2015-07-13 [1] CRAN (R 3.4.4)
##  processx      3.2.0   2018-08-16 [1] CRAN (R 3.4.4)
##  ps            1.2.0   2018-10-16 [1] CRAN (R 3.4.4)
##  purrr         0.2.5   2018-05-29 [1] CRAN (R 3.4.4)
##  R6            2.3.0   2018-10-04 [1] CRAN (R 3.4.4)
##  Rcpp          0.12.19 2018-10-01 [1] CRAN (R 3.4.4)
##  readr         1.1.1   2017-05-16 [1] CRAN (R 3.4.4)
##  remotes       2.0.1   2018-10-19 [1] CRAN (R 3.4.4)
##  reshape2      1.4.3   2017-12-11 [1] CRAN (R 3.4.4)
##  rlang         0.3.0   2018-10-22 [1] CRAN (R 3.4.4)
##  rmarkdown     1.10    2018-06-11 [1] CRAN (R 3.4.4)
##  roxygen2      6.1.0   2018-07-27 [1] CRAN (R 3.4.4)
##  rprojroot     1.3-2   2018-01-03 [1] CRAN (R 3.4.4)
##  rstudioapi    0.8     2018-10-02 [1] CRAN (R 3.4.4)
##  scales      * 1.0.0   2018-08-09 [1] CRAN (R 3.4.4)
##  sessioninfo   1.1.0   2018-09-25 [1] CRAN (R 3.4.4)
##  stringi       1.2.4   2018-07-20 [1] CRAN (R 3.4.4)
##  stringr     * 1.3.1   2018-05-10 [1] CRAN (R 3.4.4)
##  testthat      2.0.1   2018-10-13 [1] CRAN (R 3.4.4)
##  tibble        1.4.2   2018-01-22 [1] CRAN (R 3.4.4)
##  tidyselect    0.2.5   2018-10-11 [1] CRAN (R 3.4.4)
##  usethis     * 1.4.0   2018-08-14 [1] CRAN (R 3.4.4)
##  viridisLite   0.3.0   2018-02-01 [1] CRAN (R 3.4.4)
##  withr         2.1.2   2018-03-15 [1] CRAN (R 3.4.4)
##  xml2          1.2.0   2018-01-24 [1] CRAN (R 3.4.4)
##  yaml          2.2.0   2018-07-25 [1] CRAN (R 3.4.4)
## 
## [1] /home/otho/R/x86_64-pc-linux-gnu-library/3.4
## [2] /usr/local/lib/R/site-library
## [3] /usr/lib/R/site-library
## [4] /usr/lib/R/library</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#setup">Setup</a></li>
      <li><a href="#simple-workflow">Simple Workflow</a></li>
      <li>
<a href="#load-your-data-into-r">Load your data into R</a><ul class="nav nav-pills nav-stacked">
<li><a href="#tidy-your-data">Tidy your Data</a></li>
      </ul>
</li>
      <li><a href="#normalize">Normalize</a></li>
      <li><a href="#scale">Scale</a></li>
      <li>
<a href="#visualize">Visualize</a><ul class="nav nav-pills nav-stacked">
<li><a href="#what-variables-are-in-your-data">What variables are in your data?</a></li>
      <li><a href="#lineplot">Lineplot</a></li>
      </ul>
</li>
      <li><a href="#session-info">Session Info</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Otho Mantegazza.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
